# Data

```{r, include=FALSE, message=FALSE}
# dependencies
library(dplyr)
library(tidyr)
library(tidyverse)
library(reticulate)
library(redav)
```

## Description

The project makes use of datasets from the following sources:

-   [Coup d'Ã‰tat Project (CDP)](https://clinecenter.illinois.edu/project/research-themes/democracy-and-development/coup-detat-project)
-   [Rulers, Elections, and Irregular Governance dataset (REIGN)](https://oefdatascience.github.io/REIGN.github.io/menu/reign_current.html)

### The CDP Data

The CDP data is collected by the Cline Center for Advanced Social Research at the University of Illinois Urbana-Champaign. It was a collaborative work by *Buddy Peyton, Joseph Bajjalieh, Dan Shalmon, Michael Martin, Jonathan Bonaguro,* and *Scott Althaus*.

The CDP data is about coup instances. For each instance, it records information concerning

-  when and where it took place,
-  the type of its initiator (e.g. military, rebels),
-  the coup outcome (realized or not, or it is just a thwarted conspiracy),
-  the fate of the deposed leader (e.g. jailed, fled).

In its latest version, this dataset identifies 981 coup instances with 22 attributes from 1945 to 2022 and is in the CSV format. On average, new instances and attributes are updated every 6 months, starting from November 16th 2022 to February 24rd 2023.

### The REIGN Data

The REIGN data is collected by *Curtis Bell, Clayton Besaw,* and *Matthew Frank* in the CSV format. In general, it contains data concerning

-  the political leadership,
-  the regime characteristics,
-  the electoral outcomes

for every country around the globe since January 1950. Each aspect is described through numerous measures in the dataset, and in total, this massive dataset has 137,219 observations with 41 descriptive features by January 2021. Some noticeable numerical features are:

-   `age`: the national leader's age
-   `tenure_months`: the number of months a leader has been in power
-   `lastelection`: an inverted decay function that measures the time since the last election for the leadership position of the country
-   `dem_duration`: the logged number of months under democratic ruling
-   `political_violence`: the relative level (Z-score) of political violence experienced within the borders of a country for that year
-   `precip`: the Standardized Precipitation Index (SPI) for each country month
-   `couprisk`: an estimated probability of the risk of a military coup attempt

Notice that the REIGN is not coup-specific. It is a supporting source that helps us better describe the political ecosystem of a country experiencing coups. So far, this dataset has been updated for 30 times starting from February 7th, 2019 to August 3rd, 2021.

### References

You may access more informative data descriptions with *codebooks* for the [CDP](https://databank.illinois.edu/datasets/IDB-3143201) and the [REIGN](https://oefdatascience.github.io/REIGN.github.io/menu/reign_current.html) data (download links provided at the end of both webpages), and you may download the latest data to your local environment for the [CDP](https://databank.illinois.edu/datasets/IDB-3143201) and the [REIGN](https://github.com/OEFDataScience/REIGN.github.io/blob/gh-pages/data_sets/REIGN_2021_8.csv) data.

**Note**: due to maintenance issues, the REIGN data cannot be downloaded directly from their website but can be obtained through their GitHub repo.

### Data Import

We have made a copy of the datasets and saved them in the `./data/raw` folder of this project. This makes us - as well as you - to import the data.

As mentioned, the REIGN data serves as a supporting role. As a preprocessing step, we will merge the REIGN data with the CDP data using keys `country`, `year`, and `month` and keep instances in the CDP data unique. You may find the merged data in the `./data/merged` folder.

```{r, warning=FALSE}
# read both data from the project repo
cdp <- read.csv("./data/raw/Coup data 2.1.2.csv")
reign <- read.csv("./data/raw/REIGN_2021_8.csv")

# merged data using keys
merged <- cdp %>% 
  left_join(reign, by = c("cowcode"="ccode", "year"="year", "month"="month")) %>%
  # duplicates may occur if leadership changed in the year of coups
  distinct(coup_id, .keep_all = TRUE)

# export the merged data
write.csv(merged, file = "./data/merged/coup_data.csv", row.names = FALSE)

merged <- read.csv("./data/merged/coup_data.csv")
```

Notice that, because observations in both datasets can be dated long ago, it can be expected that there will be many missing values, and they also depend on the geographical location - countries might not be able to provide data for particular measures at some time. In addition, while our data describes the political aspects of countries in a comprehensive manner, bear in mind that coups are also significantly related to economic and social attributes. Although our data provides no information concerning these, feel free to be inspired and add more features for further studies!

## Research Plan (TODO)

We merge the two datasets to provide a more comprehensive picture on the political backgrounds of the coups. Using a left join from the REIGN data to the CDP data, we introduce additional information such as the type of government, coup risk, level of political violence, among many others at the time of the coup. With the merged dataset, we seek to answer the questions posed in the introduction in the following ways:

1.  Data Exploration: We will visualize the distribution of all features using a variety of plots -- barplots, scatterplots, Cleveland dot plots -- as appropriate to gain an initial understanding to the data we are working with. This will allow us to decide what features to pay special attention to in the following steps.
2.  Clustering: We will apply PCA to the numerical features mentioned above (added from the REIGN) data to perform dimension reduction before drawing the biplot. We will then be able to see clusters of the different types of government at the time of the coups and identify any outliers. Depending on whether the clusters are clear, we will also be able to infer if the type of government is highly correlated with coups happening. On the other hand, the biplot also provides insight into highly correlated and uncorrelated features, if there are any.
3.  Time series analysis: Since the data we have range from 1945 to 2020, it provides a great opportunity for us to conduct time series analysis. We plan to at least group the coups by type of government and by region, respectively, to see if the number of coups changed over the span of 75 years. We will also conduct additional time series analysis for any notable factors that stand out from the previous biplot.

## Missing value analysis

We will mainly focus on the numerical variables as well as `government` data mentioned in the previous section. As discussed, we will apply merging and cleaning to the data and then extract the subset to see if there are any missing values.

# `{r} # joined <- joined %>% #   filter_all(any_vars(!is.na(.))) %>% #   select(c("age", "tenure_months", "lastelection", #            "dem_duration", "political_violence", #            "precip", "couprisk", "pctile_risk", #            "government", "year", "month")) %>% #   rename( #     tenure = tenure_months, #     dem_dur = dem_duration, #     poli_vio = political_violence, #     gov = government #   ) #  # colSums(is.na(joined)) %>% #   sort(decreasing = TRUE) #`

# `{r, fig.width=12, fig.height=9} # plot_missing(joined, percent = FALSE) #`

After we merge the two datasets, we delete all rows that have all null values and arrive at our joined dataset with the same number of observations as the original main dataset, previously referred to as the CDP data. Out of all our features, `couprisk` and `pctile_risk` both have 446 missing values, and all other features have 73 missing values. From the above graph, we can see that roughly 1/3 of the coup observations do not have information concerning the regime type and other numerical attributes. Given that a lot of coups are from many years ago, it is not shocking that a lot of data is missing.
